to_add$Stats <- rep(levels(Gender$Stats), each = empty_bar)
Gender <- rbind(Gender, to_add)
Gender <- Gender %>% arrange(Stats)
Gender$ID <- seq(1, nrow(Gender))
label_data_Gender <- Gender
number_of_bar <- nrow(label_data_Gender)
angle <- 90 - 360 * (label_data_Gender$ID - .5) / number_of_bar
label_data_Gender$hjust <- ifelse(angle < -90, 1, 0)
label_data_Gender$angle <- ifelse(angle < -90, angle + 180, angle)
base_data_Gender <- Gender %>%
group_by(Stats) %>%
summarize(start = min(ID),
end = max(ID) - empty_bar,
N = n(), .groups = "drop") %>%
mutate(end = ifelse(N == 1, start + 1, end)) %>%
mutate(title = (start + end) / 2)
grid_data_Gender <- base_data_Gender
grid_data_Gender$end <- grid_data_Gender$end[ c( nrow(grid_data_Gender), 1:nrow(grid_data_Gender) -1)] + 1
grid_data_Gender$start <- grid_data_Gender$start - 1
grid_data_Gender <- grid_data_Gender[-1, ]
# Create a data frame with swapped x, y positions for icons and labels
data <- data.frame(x = c(.2, .6), y = c(.36, .725), label = fontawesome(c("fa-group", "fa-graduation-cap")))
text_data <- data.frame(x = c(.2, .6), y = c(.17, .55), label = c("Gênero", "Estágio Acadêmico"))
Icons <-
ggplot(data, aes(x, y, color = label, label = label)) +
geom_text(family = "fontawesome-webfont", size = 30) +
geom_text(data = text_data, aes(x, y, label = label), family = "Cormorant", size = 6, fontface = "bold", color = "#000000") +
scale_colour_manual(values = c("#fdbf6f", "#e5d8bd"), na.translate = FALSE) +
scale_x_continuous("",
limits = c(0, 1),
expand = c(0, 0)) +
scale_y_continuous("",
limits = c(0, 1),
expand = c(0, 0)) +
theme(legend.position = "none",
panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
panel.border = element_blank(),
panel.grid = element_blank(),
plot.margin = margin(t = 0, b = 0, r = 0, l = 0, unit = "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
# Generates plot ~
Gender_Plot <-
ggplot(Gender, aes(x = as.factor(ID), y = Percentage * 100, fill = Stats)) +
geom_bar(aes(x = as.factor(ID), y = Percentage * 100, fill = Stats), stat = "identity", alpha = 1) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 10, xend = start, yend = 10), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 20, xend = start, yend = 20), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 30, xend = start, yend = 30), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 40, xend = start, yend = 40), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 50, xend = start, yend = 50), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
annotate("text", x = rep(max(Gender$ID), 5), y = c(10, 20, 30, 40, 50), label = c("10%", "20%", "30%", "40%", "50%"), family = "Cormorant", size = 4, fontface = "bold", color = "#737373", angle = 0, hjust = 1) +
geom_bar(aes(x = as.factor(ID), y = Percentage * 100, fill = Region), stat = "identity", alpha = .5) +
scale_fill_manual(values = c("#e5d8bd", "#fdbf6f"), na.translate = FALSE) +
ylim(-90, 70) +
theme(panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
panel.grid = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(-2, -2, -2, -7), "cm"),
legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank()) +
coord_polar() +
geom_text(data = label_data_Gender, aes(x = ID, y = Percentage * 100 + 6, label = Variable, hjust = hjust), family = "Cormorant", size = 5, color = "#737373", fontface = "bold", angle = label_data_Gender$angle, inherit.aes = FALSE ) +
geom_segment(data = base_data_Gender, aes(x = start, y = -5, xend = end, yend = -5), colour = "#000000", alpha = 1, size = .6, inherit.aes = FALSE)
# Overlays plots ~
Gender_PlotUp <- ggdraw() +
draw_plot(Gender_Plot) +
draw_plot(Icons, x = .25, y = .31, width = .4, height = .4)
Final_Plot <- plot_grid(Institution_Plot, Gender_PlotUp, ncol = 2, rel_widths = c(.5, .5))
# Saves Institution plot ~
ggsave(Final_Plot, file = "Layka.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 30, height = 14, dpi = 600)
# Creates panel ~
MiniMap <-
ggplot() +
geom_sf(data = subset(fulldf_map, name_region != "SBBE24"), aes(fill = name_region), colour = "#f7fbff") +
geom_star(data = subset(fulldf_map, Division == "Per Region" & Region == "Abroad"),
aes(x = Longitude, y = Latitude, fill = name_region), size = 26, starshape = 8, starstroke = .3, colour = "#f7fbff") +
scale_fill_manual(values = c("#1b9e77", "#fdb462", "#fb8072", "#bebada", "#80b1d3", "#fbb4ae")) +
geom_text(data = subset(fulldf_map, Division == "Per Region" & Stats == "Members" & Region != "SBBE24"),
aes(x = Longitude, y = Latitude, label = Region_PT),
family = "Cormorant", size = 5.25, colour = "#ffffff") +
coord_sf(xlim = c(-75.75, -33),
ylim = c(-35, 6.5),
expand = FALSE) +
theme(legend.position = "none",
panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
panel.border = element_blank(),
panel.grid = element_blank(),
plot.margin =  margin(t = 0, b = 0, r = 0, l = 0, unit = "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
# Convert map plot into a grob
MiniMap_Grob <- ggplotGrob(MiniMap)
max_height <- max(Circular$Percentage, na.rm = TRUE) * 100 + 3
# Generates plot ~
Institution_Plot <-
ggplot(Circular, aes(x = as.factor(ID), y = Percentage * 100, fill = Region)) +
geom_bar(aes(x = as.factor(ID), y = Percentage * 100, fill = Region), stat = "identity", alpha = 1) +
scale_fill_manual(values = c("#1b9e77", "#fdb462", "#fb8072", "#bebada", "#80b1d3", "#fbb4ae"), na.translate = FALSE) +
geom_segment(data = grid_data_Circular, aes(x = end, y = 5, xend = start, yend = 5), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Circular, aes(x = end, y = 10, xend = start, yend = 10), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Circular, aes(x = end, y = 15, xend = start, yend = 15), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Circular, aes(x = end, y = 20, xend = start, yend = 20), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
annotate("text", x = rep(max(Circular$ID), 4), y = c(5, 10, 15, 20), label = c("5%", "10%", "15%", "20%"), family = "Cormorant", size = 4, fontface = "bold", color = "#737373", angle = 0, hjust = 1) +
geom_bar(aes(x = as.factor(ID), y = Percentage * 100, fill = Region), stat = "identity", alpha = .5) +
ylim(-100, 80) +
theme(panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
panel.grid = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(-5.8, -4, -4, -3), "cm"),
legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank()) +
coord_polar() +
#geom_text(data = label_data, aes(x = ID, y = max_height, label = Variable, hjust = hjust), family = "Barlow", size = 3.5, color = "#000000", fontface = "bold", alpha = .6, angle = label_data$angle, inherit.aes = FALSE ) +
geom_text(data = label_data_Circular, aes(x = ID, y = Percentage * 100 + 6, label = Variable, hjust = hjust), family = "Cormorant", size = 5, color = "#737373", fontface = "bold", angle = label_data_Circular$angle, inherit.aes = FALSE ) +
geom_segment(data = base_data_Circular, aes(x = start, y = -5, xend = end, yend = -5), colour = "#000000", alpha = 1, size = .6, inherit.aes = FALSE)
# Overlays plots ~
Institution_Plot <- ggdraw() +
draw_plot(Institution_Plot) +
draw_plot(MiniMap, x = .31, y = .33, width = .4, height = .4)
# Saves Institution plot ~
ggsave(Institution_Plot, file = "Institution_Plot_B.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 15, height = 14, dpi = 600)
Gender <- fulldfUp %>%
filter(Stats == "GenderMembers" | Stats == "StageMembers") %>%
droplevels() %>%
arrange(desc(Percentage))
empty_bar <- 6
to_add <- data.frame(matrix(NA, empty_bar * nlevels(Gender$Stats), ncol(Gender)))
colnames(to_add) <- colnames(Gender)
to_add$Stats <- rep(levels(Gender$Stats), each = empty_bar)
Gender <- rbind(Gender, to_add)
Gender <- Gender %>% arrange(Stats)
Gender$ID <- seq(1, nrow(Gender))
label_data_Gender <- Gender
number_of_bar <- nrow(label_data_Gender)
angle <- 90 - 360 * (label_data_Gender$ID - .5) / number_of_bar
label_data_Gender$hjust <- ifelse(angle < -90, 1, 0)
label_data_Gender$angle <- ifelse(angle < -90, angle + 180, angle)
base_data_Gender <- Gender %>%
group_by(Stats) %>%
summarize(start = min(ID),
end = max(ID) - empty_bar,
N = n(), .groups = "drop") %>%
mutate(end = ifelse(N == 1, start + 1, end)) %>%
mutate(title = (start + end) / 2)
grid_data_Gender <- base_data_Gender
grid_data_Gender$end <- grid_data_Gender$end[ c( nrow(grid_data_Gender), 1:nrow(grid_data_Gender) -1)] + 1
grid_data_Gender$start <- grid_data_Gender$start - 1
grid_data_Gender <- grid_data_Gender[-1, ]
# Create a data frame with swapped x, y positions for icons and labels
data <- data.frame(x = c(.2, .6), y = c(.36, .725), label = fontawesome(c("fa-group", "fa-graduation-cap")))
text_data <- data.frame(x = c(.2, .6), y = c(.17, .55), label = c("Gênero", "Estágio Acadêmico"))
Icons <-
ggplot(data, aes(x, y, color = label, label = label)) +
geom_text(family = "fontawesome-webfont", size = 30) +
geom_text(data = text_data, aes(x, y, label = label), family = "Cormorant", size = 6, fontface = "bold", color = "#000000") +
scale_colour_manual(values = c("#fdbf6f", "#e5d8bd"), na.translate = FALSE) +
scale_x_continuous("",
limits = c(0, 1),
expand = c(0, 0)) +
scale_y_continuous("",
limits = c(0, 1),
expand = c(0, 0)) +
theme(legend.position = "none",
panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
panel.border = element_blank(),
panel.grid = element_blank(),
plot.margin = margin(t = 0, b = 0, r = 0, l = 0, unit = "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
# Generates plot ~
Gender_Plot <-
ggplot(Gender, aes(x = as.factor(ID), y = Percentage * 100, fill = Stats)) +
geom_bar(aes(x = as.factor(ID), y = Percentage * 100, fill = Stats), stat = "identity", alpha = 1) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 10, xend = start, yend = 10), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 20, xend = start, yend = 20), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 30, xend = start, yend = 30), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 40, xend = start, yend = 40), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 50, xend = start, yend = 50), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
annotate("text", x = rep(max(Gender$ID), 5), y = c(10, 20, 30, 40, 50), label = c("10%", "20%", "30%", "40%", "50%"), family = "Cormorant", size = 4, fontface = "bold", color = "#737373", angle = 0, hjust = 1) +
geom_bar(aes(x = as.factor(ID), y = Percentage * 100, fill = Region), stat = "identity", alpha = .5) +
scale_fill_manual(values = c("#e5d8bd", "#fdbf6f"), na.translate = FALSE) +
ylim(-90, 70) +
theme(panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
panel.grid = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(-2, -2, -2, -7), "cm"),
legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank()) +
coord_polar() +
geom_text(data = label_data_Gender, aes(x = ID, y = Percentage * 100 + 6, label = Variable, hjust = hjust), family = "Cormorant", size = 5, color = "#737373", fontface = "bold", angle = label_data_Gender$angle, inherit.aes = FALSE ) +
geom_segment(data = base_data_Gender, aes(x = start, y = -5, xend = end, yend = -5), colour = "#000000", alpha = 1, size = .6, inherit.aes = FALSE)
# Overlays plots ~
Gender_PlotUp <- ggdraw() +
draw_plot(Gender_Plot) +
draw_plot(Icons, x = .25, y = .31, width = .4, height = .4)
Final_Plot <- plot_grid(Institution_Plot, Gender_PlotUp, ncol = 2, rel_widths = c(.5, .5))
# Saves Institution plot ~
ggsave(Final_Plot, file = "Layka.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 30, height = 14, dpi = 600)
# Creates panel ~
MiniMap <-
ggplot() +
geom_sf(data = subset(fulldf_map, name_region != "SBBE24"), aes(fill = name_region), colour = "#f7fbff") +
geom_star(data = subset(fulldf_map, Division == "Per Region" & Region == "Abroad"),
aes(x = Longitude, y = Latitude, fill = name_region), size = 26, starshape = 8, starstroke = .3, colour = "#f7fbff") +
scale_fill_manual(values = c("#1b9e77", "#fdb462", "#fb8072", "#bebada", "#80b1d3", "#e41a1c")) +
geom_text(data = subset(fulldf_map, Division == "Per Region" & Stats == "Members" & Region != "SBBE24"),
aes(x = Longitude, y = Latitude, label = Region_PT),
family = "Cormorant", size = 5.25, colour = "#ffffff") +
coord_sf(xlim = c(-75.75, -33),
ylim = c(-35, 6.5),
expand = FALSE) +
theme(legend.position = "none",
panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
panel.border = element_blank(),
panel.grid = element_blank(),
plot.margin =  margin(t = 0, b = 0, r = 0, l = 0, unit = "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
# Convert map plot into a grob
MiniMap_Grob <- ggplotGrob(MiniMap)
max_height <- max(Circular$Percentage, na.rm = TRUE) * 100 + 3
# Generates plot ~
Institution_Plot <-
ggplot(Circular, aes(x = as.factor(ID), y = Percentage * 100, fill = Region)) +
geom_bar(aes(x = as.factor(ID), y = Percentage * 100, fill = Region), stat = "identity", alpha = 1) +
scale_fill_manual(values = c("#1b9e77", "#fdb462", "#fb8072", "#bebada", "#80b1d3", "#e41a1c"), na.translate = FALSE) +
geom_segment(data = grid_data_Circular, aes(x = end, y = 5, xend = start, yend = 5), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Circular, aes(x = end, y = 10, xend = start, yend = 10), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Circular, aes(x = end, y = 15, xend = start, yend = 15), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Circular, aes(x = end, y = 20, xend = start, yend = 20), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
annotate("text", x = rep(max(Circular$ID), 4), y = c(5, 10, 15, 20), label = c("5%", "10%", "15%", "20%"), family = "Cormorant", size = 4, fontface = "bold", color = "#737373", angle = 0, hjust = 1) +
geom_bar(aes(x = as.factor(ID), y = Percentage * 100, fill = Region), stat = "identity", alpha = .5) +
ylim(-100, 80) +
theme(panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
panel.grid = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(-5.8, -4, -4, -3), "cm"),
legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank()) +
coord_polar() +
#geom_text(data = label_data, aes(x = ID, y = max_height, label = Variable, hjust = hjust), family = "Barlow", size = 3.5, color = "#000000", fontface = "bold", alpha = .6, angle = label_data$angle, inherit.aes = FALSE ) +
geom_text(data = label_data_Circular, aes(x = ID, y = Percentage * 100 + 6, label = Variable, hjust = hjust), family = "Cormorant", size = 5, color = "#737373", fontface = "bold", angle = label_data_Circular$angle, inherit.aes = FALSE ) +
geom_segment(data = base_data_Circular, aes(x = start, y = -5, xend = end, yend = -5), colour = "#000000", alpha = 1, size = .6, inherit.aes = FALSE)
# Overlays plots ~
Institution_Plot <- ggdraw() +
draw_plot(Institution_Plot) +
draw_plot(MiniMap, x = .31, y = .33, width = .4, height = .4)
# Saves Institution plot ~
ggsave(Institution_Plot, file = "Institution_Plot_B.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 15, height = 14, dpi = 600)
Gender <- fulldfUp %>%
filter(Stats == "GenderMembers" | Stats == "StageMembers") %>%
droplevels() %>%
arrange(desc(Percentage))
empty_bar <- 6
to_add <- data.frame(matrix(NA, empty_bar * nlevels(Gender$Stats), ncol(Gender)))
colnames(to_add) <- colnames(Gender)
to_add$Stats <- rep(levels(Gender$Stats), each = empty_bar)
Gender <- rbind(Gender, to_add)
Gender <- Gender %>% arrange(Stats)
Gender$ID <- seq(1, nrow(Gender))
label_data_Gender <- Gender
number_of_bar <- nrow(label_data_Gender)
angle <- 90 - 360 * (label_data_Gender$ID - .5) / number_of_bar
label_data_Gender$hjust <- ifelse(angle < -90, 1, 0)
label_data_Gender$angle <- ifelse(angle < -90, angle + 180, angle)
base_data_Gender <- Gender %>%
group_by(Stats) %>%
summarize(start = min(ID),
end = max(ID) - empty_bar,
N = n(), .groups = "drop") %>%
mutate(end = ifelse(N == 1, start + 1, end)) %>%
mutate(title = (start + end) / 2)
grid_data_Gender <- base_data_Gender
grid_data_Gender$end <- grid_data_Gender$end[ c( nrow(grid_data_Gender), 1:nrow(grid_data_Gender) -1)] + 1
grid_data_Gender$start <- grid_data_Gender$start - 1
grid_data_Gender <- grid_data_Gender[-1, ]
# Create a data frame with swapped x, y positions for icons and labels
data <- data.frame(x = c(.2, .6), y = c(.36, .725), label = fontawesome(c("fa-group", "fa-graduation-cap")))
text_data <- data.frame(x = c(.2, .6), y = c(.17, .55), label = c("Gênero", "Estágio Acadêmico"))
Icons <-
ggplot(data, aes(x, y, color = label, label = label)) +
geom_text(family = "fontawesome-webfont", size = 30) +
geom_text(data = text_data, aes(x, y, label = label), family = "Cormorant", size = 6, fontface = "bold", color = "#000000") +
scale_colour_manual(values = c("#fdbf6f", "#e5d8bd"), na.translate = FALSE) +
scale_x_continuous("",
limits = c(0, 1),
expand = c(0, 0)) +
scale_y_continuous("",
limits = c(0, 1),
expand = c(0, 0)) +
theme(legend.position = "none",
panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
panel.border = element_blank(),
panel.grid = element_blank(),
plot.margin = margin(t = 0, b = 0, r = 0, l = 0, unit = "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
# Generates plot ~
Gender_Plot <-
ggplot(Gender, aes(x = as.factor(ID), y = Percentage * 100, fill = Stats)) +
geom_bar(aes(x = as.factor(ID), y = Percentage * 100, fill = Stats), stat = "identity", alpha = 1) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 10, xend = start, yend = 10), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 20, xend = start, yend = 20), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 30, xend = start, yend = 30), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 40, xend = start, yend = 40), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 50, xend = start, yend = 50), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
annotate("text", x = rep(max(Gender$ID), 5), y = c(10, 20, 30, 40, 50), label = c("10%", "20%", "30%", "40%", "50%"), family = "Cormorant", size = 4, fontface = "bold", color = "#737373", angle = 0, hjust = 1) +
geom_bar(aes(x = as.factor(ID), y = Percentage * 100, fill = Region), stat = "identity", alpha = .5) +
scale_fill_manual(values = c("#e5d8bd", "#fdbf6f"), na.translate = FALSE) +
ylim(-90, 70) +
theme(panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
panel.grid = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(-2, -2, -2, -7), "cm"),
legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank()) +
coord_polar() +
geom_text(data = label_data_Gender, aes(x = ID, y = Percentage * 100 + 6, label = Variable, hjust = hjust), family = "Cormorant", size = 5, color = "#737373", fontface = "bold", angle = label_data_Gender$angle, inherit.aes = FALSE ) +
geom_segment(data = base_data_Gender, aes(x = start, y = -5, xend = end, yend = -5), colour = "#000000", alpha = 1, size = .6, inherit.aes = FALSE)
# Overlays plots ~
Gender_PlotUp <- ggdraw() +
draw_plot(Gender_Plot) +
draw_plot(Icons, x = .25, y = .31, width = .4, height = .4)
Final_Plot <- plot_grid(Institution_Plot, Gender_PlotUp, ncol = 2, rel_widths = c(.5, .5))
# Saves Institution plot ~
ggsave(Final_Plot, file = "Layka.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 30, height = 14, dpi = 600)
# Creates panel ~
MiniMap <-
ggplot() +
geom_sf(data = subset(fulldf_map, name_region != "SBBE24"), aes(fill = name_region), colour = "#f7fbff") +
geom_star(data = subset(fulldf_map, Division == "Per Region" & Region == "Abroad"),
aes(x = Longitude, y = Latitude, fill = name_region), size = 26, starshape = 8, starstroke = .3, colour = "#f7fbff") +
scale_fill_manual(values = c("#1b9e77", "#fdb462", "#fb8072", "#bebada", "#80b1d3", "#c994c7")) +
geom_text(data = subset(fulldf_map, Division == "Per Region" & Stats == "Members" & Region != "SBBE24"),
aes(x = Longitude, y = Latitude, label = Region_PT),
family = "Cormorant", size = 5.25, colour = "#ffffff") +
coord_sf(xlim = c(-75.75, -33),
ylim = c(-35, 6.5),
expand = FALSE) +
theme(legend.position = "none",
panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
panel.border = element_blank(),
panel.grid = element_blank(),
plot.margin =  margin(t = 0, b = 0, r = 0, l = 0, unit = "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
# Convert map plot into a grob
MiniMap_Grob <- ggplotGrob(MiniMap)
max_height <- max(Circular$Percentage, na.rm = TRUE) * 100 + 3
# Generates plot ~
Institution_Plot <-
ggplot(Circular, aes(x = as.factor(ID), y = Percentage * 100, fill = Region)) +
geom_bar(aes(x = as.factor(ID), y = Percentage * 100, fill = Region), stat = "identity", alpha = 1) +
scale_fill_manual(values = c("#1b9e77", "#fdb462", "#fb8072", "#bebada", "#80b1d3", "#c994c7"), na.translate = FALSE) +
geom_segment(data = grid_data_Circular, aes(x = end, y = 5, xend = start, yend = 5), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Circular, aes(x = end, y = 10, xend = start, yend = 10), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Circular, aes(x = end, y = 15, xend = start, yend = 15), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Circular, aes(x = end, y = 20, xend = start, yend = 20), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
annotate("text", x = rep(max(Circular$ID), 4), y = c(5, 10, 15, 20), label = c("5%", "10%", "15%", "20%"), family = "Cormorant", size = 4, fontface = "bold", color = "#737373", angle = 0, hjust = 1) +
geom_bar(aes(x = as.factor(ID), y = Percentage * 100, fill = Region), stat = "identity", alpha = .5) +
ylim(-100, 80) +
theme(panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
panel.grid = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(-5.8, -4, -4, -3), "cm"),
legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank()) +
coord_polar() +
#geom_text(data = label_data, aes(x = ID, y = max_height, label = Variable, hjust = hjust), family = "Barlow", size = 3.5, color = "#000000", fontface = "bold", alpha = .6, angle = label_data$angle, inherit.aes = FALSE ) +
geom_text(data = label_data_Circular, aes(x = ID, y = Percentage * 100 + 6, label = Variable, hjust = hjust), family = "Cormorant", size = 5, color = "#737373", fontface = "bold", angle = label_data_Circular$angle, inherit.aes = FALSE ) +
geom_segment(data = base_data_Circular, aes(x = start, y = -5, xend = end, yend = -5), colour = "#000000", alpha = 1, size = .6, inherit.aes = FALSE)
# Overlays plots ~
Institution_Plot <- ggdraw() +
draw_plot(Institution_Plot) +
draw_plot(MiniMap, x = .31, y = .33, width = .4, height = .4)
# Saves Institution plot ~
ggsave(Institution_Plot, file = "Institution_Plot_B.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 15, height = 14, dpi = 600)
Gender <- fulldfUp %>%
filter(Stats == "GenderMembers" | Stats == "StageMembers") %>%
droplevels() %>%
arrange(desc(Percentage))
empty_bar <- 6
to_add <- data.frame(matrix(NA, empty_bar * nlevels(Gender$Stats), ncol(Gender)))
colnames(to_add) <- colnames(Gender)
to_add$Stats <- rep(levels(Gender$Stats), each = empty_bar)
Gender <- rbind(Gender, to_add)
Gender <- Gender %>% arrange(Stats)
Gender$ID <- seq(1, nrow(Gender))
label_data_Gender <- Gender
number_of_bar <- nrow(label_data_Gender)
angle <- 90 - 360 * (label_data_Gender$ID - .5) / number_of_bar
label_data_Gender$hjust <- ifelse(angle < -90, 1, 0)
label_data_Gender$angle <- ifelse(angle < -90, angle + 180, angle)
base_data_Gender <- Gender %>%
group_by(Stats) %>%
summarize(start = min(ID),
end = max(ID) - empty_bar,
N = n(), .groups = "drop") %>%
mutate(end = ifelse(N == 1, start + 1, end)) %>%
mutate(title = (start + end) / 2)
grid_data_Gender <- base_data_Gender
grid_data_Gender$end <- grid_data_Gender$end[ c( nrow(grid_data_Gender), 1:nrow(grid_data_Gender) -1)] + 1
grid_data_Gender$start <- grid_data_Gender$start - 1
grid_data_Gender <- grid_data_Gender[-1, ]
# Create a data frame with swapped x, y positions for icons and labels
data <- data.frame(x = c(.2, .6), y = c(.36, .725), label = fontawesome(c("fa-group", "fa-graduation-cap")))
text_data <- data.frame(x = c(.2, .6), y = c(.17, .55), label = c("Gênero", "Estágio Acadêmico"))
Icons <-
ggplot(data, aes(x, y, color = label, label = label)) +
geom_text(family = "fontawesome-webfont", size = 30) +
geom_text(data = text_data, aes(x, y, label = label), family = "Cormorant", size = 6, fontface = "bold", color = "#000000") +
scale_colour_manual(values = c("#fdbf6f", "#e5d8bd"), na.translate = FALSE) +
scale_x_continuous("",
limits = c(0, 1),
expand = c(0, 0)) +
scale_y_continuous("",
limits = c(0, 1),
expand = c(0, 0)) +
theme(legend.position = "none",
panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
panel.border = element_blank(),
panel.grid = element_blank(),
plot.margin = margin(t = 0, b = 0, r = 0, l = 0, unit = "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
# Generates plot ~
Gender_Plot <-
ggplot(Gender, aes(x = as.factor(ID), y = Percentage * 100, fill = Stats)) +
geom_bar(aes(x = as.factor(ID), y = Percentage * 100, fill = Stats), stat = "identity", alpha = 1) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 10, xend = start, yend = 10), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 20, xend = start, yend = 20), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 30, xend = start, yend = 30), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 40, xend = start, yend = 40), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 50, xend = start, yend = 50), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
annotate("text", x = rep(max(Gender$ID), 5), y = c(10, 20, 30, 40, 50), label = c("10%", "20%", "30%", "40%", "50%"), family = "Cormorant", size = 4, fontface = "bold", color = "#737373", angle = 0, hjust = 1) +
geom_bar(aes(x = as.factor(ID), y = Percentage * 100, fill = Region), stat = "identity", alpha = .5) +
scale_fill_manual(values = c("#e5d8bd", "#fdbf6f"), na.translate = FALSE) +
ylim(-90, 70) +
theme(panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
panel.grid = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(-2, -2, -2, -7), "cm"),
legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank()) +
coord_polar() +
geom_text(data = label_data_Gender, aes(x = ID, y = Percentage * 100 + 6, label = Variable, hjust = hjust), family = "Cormorant", size = 5, color = "#737373", fontface = "bold", angle = label_data_Gender$angle, inherit.aes = FALSE ) +
geom_segment(data = base_data_Gender, aes(x = start, y = -5, xend = end, yend = -5), colour = "#000000", alpha = 1, size = .6, inherit.aes = FALSE)
# Overlays plots ~
Gender_PlotUp <- ggdraw() +
draw_plot(Gender_Plot) +
draw_plot(Icons, x = .25, y = .31, width = .4, height = .4)
Final_Plot <- plot_grid(Institution_Plot, Gender_PlotUp, ncol = 2, rel_widths = c(.5, .5))
# Saves Institution plot ~
ggsave(Final_Plot, file = "Layka.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 30, height = 14, dpi = 600)
# Overlays plots ~
Gender_PlotUp <- ggdraw() +
draw_plot(Gender_Plot) +
draw_plot(Icons, x = .28, y = .31, width = .4, height = .4)
Final_Plot <- plot_grid(Institution_Plot, Gender_PlotUp, ncol = 2, rel_widths = c(.5, .5))
# Saves Institution plot ~
ggsave(Final_Plot, file = "Layka.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 30, height = 14, dpi = 600)
# Overlays plots ~
Gender_PlotUp <- ggdraw() +
draw_plot(Gender_Plot) +
draw_plot(Icons, x = .27, y = .31, width = .4, height = .4)
Final_Plot <- plot_grid(Institution_Plot, Gender_PlotUp, ncol = 2, rel_widths = c(.5, .5))
# Saves Institution plot ~
ggsave(Final_Plot, file = "Layka.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 30, height = 14, dpi = 600)
