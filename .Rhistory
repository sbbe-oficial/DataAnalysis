geom_bar(aes(x = as.factor(ID), y = Percentage * 100, fill = Region), stat = "identity", alpha = .5) +
ylim(-100, 80) +
theme(panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
panel.grid = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(-5.8, -4, -4, -3), "cm"),
legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank()) +
coord_polar() +
#geom_text(data = label_data, aes(x = ID, y = max_height, label = Variable, hjust = hjust), family = "Barlow", size = 3.5, color = "#000000", fontface = "bold", alpha = .6, angle = label_data$angle, inherit.aes = FALSE ) +
geom_text(data = label_data_Circular, aes(x = ID, y = Percentage * 100 + 6, label = Variable, hjust = hjust), family = "Cormorant", size = 5, color = "#737373", fontface = "bold", angle = label_data_Circular$angle, inherit.aes = FALSE ) +
geom_segment(data = base_data_Circular, aes(x = start, y = -5, xend = end, yend = -5), colour = "#000000", alpha = 1, size = .6, inherit.aes = FALSE)
# Overlays plots ~
Institution_Plot <- ggdraw() +
draw_plot(Institution_Plot) +
draw_plot(MiniMap, x = .31, y = .33, width = .4, height = .4)
# Saves Institution plot ~
ggsave(Institution_Plot, file = "Institution_Plot_B.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 15, height = 14, dpi = 600)
Gender <- fulldfUp %>%
filter(Stats == "GenderMembers" | Stats == "StageMembers") %>%
droplevels() %>%
arrange(desc(Percentage))
empty_bar <- 6
to_add <- data.frame(matrix(NA, empty_bar * nlevels(Gender$Stats), ncol(Gender)))
colnames(to_add) <- colnames(Gender)
to_add$Stats <- rep(levels(Gender$Stats), each = empty_bar)
Gender <- rbind(Gender, to_add)
Gender <- Gender %>% arrange(Stats)
Gender$ID <- seq(1, nrow(Gender))
label_data_Gender <- Gender
number_of_bar <- nrow(label_data_Gender)
angle <- 90 - 360 * (label_data_Gender$ID - .5) / number_of_bar
label_data_Gender$hjust <- ifelse(angle < -90, 1, 0)
label_data_Gender$angle <- ifelse(angle < -90, angle + 180, angle)
base_data_Gender <- Gender %>%
group_by(Stats) %>%
summarize(start = min(ID),
end = max(ID) - empty_bar,
N = n(), .groups = "drop") %>%
mutate(end = ifelse(N == 1, start + 1, end)) %>%
mutate(title = (start + end) / 2)
grid_data_Gender <- base_data_Gender
grid_data_Gender$end <- grid_data_Gender$end[ c( nrow(grid_data_Gender), 1:nrow(grid_data_Gender) -1)] + 1
grid_data_Gender$start <- grid_data_Gender$start - 1
grid_data_Gender <- grid_data_Gender[-1, ]
# Create a data frame with swapped x, y positions for icons and labels
data <- data.frame(x = c(.2, .2, .6), y = c(.36, .43, .725), label = fontawesome(c("fa-venus-mars", "fa-genderless", "fa-graduation-cap")))
text_data <- data.frame(x = c(.2, .6), y = c(.17, .55), label = c("Gênero", "Estágio Acadêmico"))
Icons <-
ggplot(data, aes(x, y, color = label, label = label)) +
geom_text(family = "fontawesome-webfont", size = 30) +
scale_colour_manual(values = c("#e5d8bd", "#fdbf6f", "#fdbf6f"), na.translate = FALSE) +
geom_text(data = text_data, aes(x, y, label = label), family = "Cormorant", size = 6, fontface = "bold", color = "#000000") +
scale_x_continuous("", limits = c(0, 1), expand = c(0, 0)) +
scale_y_continuous("", limits = c(0, 1), expand = c(0, 0)) +
theme(legend.position = "none",
panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
panel.border = element_blank(),
panel.grid = element_blank(),
plot.margin = margin(t = 0, b = 0, r = 0, l = 0, unit = "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
# Generates plot ~
Gender_Plot <-
ggplot(Gender, aes(x = as.factor(ID), y = Percentage * 100, fill = Stats)) +
geom_bar(aes(x = as.factor(ID), y = Percentage * 100, fill = Stats), stat = "identity", alpha = 1) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 10, xend = start, yend = 10), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 20, xend = start, yend = 20), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 30, xend = start, yend = 30), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 40, xend = start, yend = 40), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
geom_segment(data = grid_data_Gender, aes(x = end, y = 50, xend = start, yend = 50), colour = "#737373", alpha = 1, linewidth = .4, linetype = 4, inherit.aes = FALSE ) +
annotate("text", x = rep(max(Gender$ID), 5), y = c(10, 20, 30, 40, 50), label = c("10%", "20%", "30%", "40%", "50%"), family = "Cormorant", size = 4, fontface = "bold", color = "#737373", angle = 0, hjust = 1) +
geom_bar(aes(x = as.factor(ID), y = Percentage * 100, fill = Region), stat = "identity", alpha = .5) +
scale_fill_manual(values = c("#e5d8bd", "#fdbf6f"), na.translate = FALSE) +
ylim(-90, 70) +
theme(panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
panel.grid = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(-2, -2, -2, -7), "cm"),
legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank()) +
coord_polar() +
geom_text(data = label_data_Gender, aes(x = ID, y = Percentage * 100 + 6, label = Variable, hjust = hjust), family = "Cormorant", size = 5, color = "#737373", fontface = "bold", angle = label_data_Gender$angle, inherit.aes = FALSE ) +
geom_segment(data = base_data_Gender, aes(x = start, y = -5, xend = end, yend = -5), colour = "#000000", alpha = 1, size = .6, inherit.aes = FALSE)
# Overlays plots ~
Gender_PlotUp <- ggdraw() +
draw_plot(Gender_Plot) +
draw_plot(Icons, x = .27, y = .31, width = .4, height = .4)
# Create a data frame with text positions
text <- data.frame(x = c(.2, .4, .6, .8), y = c(.6, .6, .6, .6),
label = c("Afiliados", "Instituições", "Eventos", "Redes Sociais"))
numbers_1 <- data.frame(x = c(.2, .4, .6), y = c(.425, .425, .425), label = c("234", "58", "01"))
numbers_2 <- data.frame(x = c(.8, .8), y = c(.425, .22), label = c("1.932", "100"))
icons_1 <- data.frame(x = c(.2, .4, .6), y = c(.22, .22, .22),
label = fontawesome(c("fa-users", "fa-university", "fa-calendar")))
icons_2 <- data.frame(x = c(.885, .885), y = c(.425, .22),
label = fontawesome(c("fa-instagram", "fa-twitter")))
# Create the plot
Geral_Plot <-
ggplot() +
geom_text(data = text, aes(x, y, label = label), color = "#ffffff", size = 10, fontface = "bold", family = "Cormorant") +
geom_text(data = numbers_1, aes(x, y, label = label), color = "#ffffff", size = 16, fontface = "bold", family = "Cormorant") +
geom_text(data = numbers_2, aes(x, y, label = label), color = "#ffffff", size = 16, fontface = "bold", family = "Cormorant") +
geom_text(data = icons_1, aes(x, y, label = label), family = "fontawesome-webfont", size = 12, color = "#ffffff") +
geom_text(data = icons_2, aes(x, y, label = label), family = "fontawesome-webfont", size = 12, color = "#ffffff") +
annotate("text", x = .5, y = .85, label = "A SBBE em Números",
family = "Cormorant", size = 12, fontface = "bold", color = "#ffffff") +
scale_x_continuous(limits = c(0, 1), expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 1), expand = c(0, 0)) +
theme(panel.background = element_rect(fill = "#365338", color = NA),
plot.background = element_rect(fill = "#365338", color = NA),
panel.grid = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(0, 0, 0, -1), "cm"),
legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
# Creates panel ~
Map <-
ggplot() +
geom_sf(data = fulldf_map, aes(fill = Percentage * 100), colour = "#f7fbff") +
coord_sf(xlim = c(-75.75, -33),
ylim = c(-35, 6.5),
expand = FALSE) +
scale_y_continuous(breaks = c(0, -10, -20, -30)) +
geom_star(data = subset(fulldf_map, Division == "Per Region" & Stats == "Members" & Region == "SBBE24"),
aes(x = Longitude, y = Latitude), size = 4, starshape = 15, starstroke = .3, fill = "#FF7B00", colour = "#000000") +
geom_star(data = subset(fulldf_map, Division == "Per Region" & Region == "Abroad"),
aes(x = Longitude, y = Latitude, fill = Percentage), size = 30, starshape = 8, starstroke = .3, colour = "#f7fbff") +
geom_label(data = subset(fulldf_map, Division == "Per Region" & Stats == "Members" & Region != "SBBE24"),
aes(x = Longitude, y = Latitude, label = Region_PT),
size = 4.5, label.size = .1, family = "Cormorant", fill = "#f7fbff", colour = "#000000") +
geom_label(data = subset(fulldf_map,  Division == "Per Region" & Stats == "Members" & Region == "Abroad"),
aes(x = Longitude, y = Latitude, label = Region_PT),
size = 4.5, label.size = .1, family = "Cormorant", fill = "#f7fbff", colour = "#000000") +
geom_label_repel(data = subset(fulldf_map, Division == "Per Region" & Stats == "Members" & Region == "SBBE24"),
aes(x = Longitude, y = Latitude, label = Region_PT), point.padding = 0,
nudge_x = 3.6, nudge_y = -1, segment.size = 0, segment.color = NA,
size = 4.5, label.size = .1, family = "Cormorant", fill = "#FF7B00", colour = "#000000") +
scale_fill_continuous(low = "#d6d6d6", high = "#004529",
breaks = c(10, 20, 30, 40, 50),
labels = c("10%", "20%", "30%", "40%", "50%"),
limits = c(0, 60)) +
facet_grid(Stats ~ Division, labeller = labeller(Division = xlabel_PT, Stats = ylabel_PT)) +
annotation_scale(data = subset(fulldf_map, Division == "Por Região" & Stats == "Members"),
text_family = "Cormorant", location = "bl", line_width = 1.25, text_cex = 1, style = "ticks",
pad_x = unit(.2, "in"), pad_y = unit(.2, "in")) +
annotation_north_arrow(data = subset(fulldf_map, Division == "Por Região" & Stats == "Members"),
location = "bl", which_north = "true", style = north_arrow_fancy_orienteering,
pad_x = unit(.2, "in"), pad_y = unit(.3, "in")) +
theme(legend.position = "right",
legend.margin = margin(t = 0, b = 0, r = 0, l = 30),
legend.box.margin = margin(t = 0, b = 20, r = 0, l = 0),
panel.background = element_rect(fill = "#f7fbff"),
panel.border = element_rect(colour = "#000000", linewidth = .25, fill = NA),
panel.grid.major = element_line(color = "#d9d9d9", linetype = "dashed", linewidth = .00005),
plot.margin =  margin(t = 0, b = 0, r = .5, l = .5, unit = "cm"),
axis.text = element_text(family = "Cormorant", color = "#000000", size = 13, face = "bold"),
axis.title = element_blank(),
axis.ticks = element_line(color = "#000000", linewidth = .25),
strip.text = element_text(family = "Cormorant", colour = "#000000", size = 22, face = "bold"),
strip.background = element_rect(colour = "#000000", fill = "#d6d6d6", linewidth = .25)) +
guides(fill = guide_colourbar(title = "", label.theme = element_text(family = "Cormorant", size = 14, face = "bold"),
barwidth = 1.5, barheight = 14, order = 1, frame.linetype = 1, frame.colour = "#000000",
ticks.colour = "#f7fbff", direction = "vertical", reverse = FALSE, even.steps = TRUE,
draw.ulim = TRUE, draw.llim = TRUE))
Final_Panel <- ggarrange(Institution_Plot, Gender_PlotUp, Geral_Plot, Map,
ncol = 2, nrow = 2,
heights = c(1, .5),
widths = c(1, 1))
# Creates panel ~
Map <-
ggplot() +
geom_sf(data = fulldf_map, aes(fill = Percentage * 100), colour = "#f7fbff") +
coord_sf(xlim = c(-75.75, -33),
ylim = c(-35, 6.5),
expand = FALSE) +
scale_y_continuous(breaks = c(0, -10, -20, -30)) +
geom_star(data = subset(fulldf_map, Division == "Per Region" & Stats == "Members" & Region == "SBBE24"),
aes(x = Longitude, y = Latitude), size = 4, starshape = 15, starstroke = .3, fill = "#FF7B00", colour = "#000000") +
geom_star(data = subset(fulldf_map, Division == "Per Region" & Region == "Abroad"),
aes(x = Longitude, y = Latitude, fill = Percentage), size = 30, starshape = 8, starstroke = .3, colour = "#f7fbff") +
geom_label(data = subset(fulldf_map, Division == "Per Region" & Stats == "Members" & Region != "SBBE24"),
aes(x = Longitude, y = Latitude, label = Region_PT),
size = 4.5, label.size = .1, family = "Cormorant", fill = "#f7fbff", colour = "#000000") +
geom_label(data = subset(fulldf_map,  Division == "Per Region" & Stats == "Members" & Region == "Abroad"),
aes(x = Longitude, y = Latitude, label = Region_PT),
size = 4.5, label.size = .1, family = "Cormorant", fill = "#f7fbff", colour = "#000000") +
geom_label_repel(data = subset(fulldf_map, Division == "Per Region" & Stats == "Members" & Region == "SBBE24"),
aes(x = Longitude, y = Latitude, label = Region_PT), point.padding = 0,
nudge_x = 3.6, nudge_y = -1, segment.size = 0, segment.color = NA,
size = 4.5, label.size = .1, family = "Cormorant", fill = "#FF7B00", colour = "#000000") +
scale_fill_continuous(low = "#d6d6d6", high = "#004529",
breaks = c(10, 20, 30, 40, 50),
labels = c("10%", "20%", "30%", "40%", "50%"),
limits = c(0, 60)) +
facet_grid(Stats ~ Division, labeller = labeller(Division = xlabel_PT, Stats = ylabel_PT)) +
annotation_scale(data = subset(fulldf_map, Division == "Por Região" & Stats == "Members"),
text_family = "Cormorant", location = "bl", line_width = 1.25, text_cex = 1, style = "ticks",
pad_x = unit(.2, "in"), pad_y = unit(.2, "in")) +
annotation_north_arrow(data = subset(fulldf_map, Division == "Por Região" & Stats == "Members"),
location = "bl", which_north = "true", style = north_arrow_fancy_orienteering,
pad_x = unit(.2, "in"), pad_y = unit(.3, "in")) +
theme(legend.position = "right",
legend.margin = margin(t = 0, b = 0, r = 0, l = 30),
legend.box.margin = margin(t = 0, b = 20, r = 0, l = 0),
panel.background = element_rect(fill = "#f7fbff"),
panel.border = element_rect(colour = "#000000", linewidth = .25, fill = NA),
panel.grid.major = element_line(color = "#d9d9d9", linetype = "dashed", linewidth = .00005),
plot.margin =  margin(t = 0, b = 0, r = .5, l = .5, unit = "cm"),
axis.text = element_text(color = "#000000", size = 13, face = "bold"),
axis.title = element_blank(),
axis.ticks = element_line(color = "#000000", linewidth = .25),
strip.text = element_text(family = "Cormorant", colour = "#000000", size = 22, face = "bold"),
strip.background = element_rect(colour = "#000000", fill = "#d6d6d6", linewidth = .25)) +
guides(fill = guide_colourbar(title = "", label.theme = element_text(family = "Cormorant", size = 14, face = "bold"),
barwidth = 1.5, barheight = 14, order = 1, frame.linetype = 1, frame.colour = "#000000",
ticks.colour = "#f7fbff", direction = "vertical", reverse = FALSE, even.steps = TRUE,
draw.ulim = TRUE, draw.llim = TRUE))
Final_Panel <- ggarrange(Institution_Plot, Gender_PlotUp, Geral_Plot, Map,
ncol = 2, nrow = 2,
heights = c(1, .5),
widths = c(1, 1))
# Saves Institution plot ~
ggsave(Final_Panel, file = "SBBEPanel.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 30, height = 22, dpi = 600)
# Saves Institution plot ~
ggsave(Final_Panel, file = "SBBEPanel.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 50, height = 50, dpi = 600)
# Saves Institution plot ~
ggsave(Final_Panel, file = "SBBEPanel.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 30, height = 22, dpi = 600)
Final_Panel <- ggarrange(Geral_Plot, Map, Institution_Plot, Gender_PlotUp,
ncol = 2, nrow = 3,
heights = c(1, .5),
widths = c(1, 1))
# Saves Institution plot ~
ggsave(Final_Panel, file = "SBBEPanel.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 30, height = 22, dpi = 600)
Final_Panel <- ggarrange(Geral_Plot, Map, Institution_Plot, Gender_PlotUp,
ncol = 2, nrow = 3,
heights = c(1, 1, 0.5),
widths = c(1, 1))
# Saves Institution plot ~
ggsave(Final_Panel, file = "SBBEPanel.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 30, height = 22, dpi = 600)
Final_Panel <- (Geral_Plot) / Map / (Institution_Plot | Gender_PlotUp)
Final_Panel <- Geral_Plot / Map / (Institution_Plot | Gender_PlotUp)
# Loads packages ~
pacman::p_load(tidyverse, ggstar, ggrepel, shadowtext, readxl, writexl, cowplot, patchwork, ggpubr, lemon, reshape2, writexl, stringr, lubridate,
geobr, ggspatial, showtext, png, extrafont, sf, ggiraphExtra, fontawesome, shiny, DT,
rvest, stringr, purrr, tibble, dplyr, extrafont, emojifont)
Final_Panel <- Geral_Plot / Map / (Institution_Plot | Gender_PlotUp)
# Saves Institution plot ~
ggsave(Final_Panel, file = "SBBEPanel.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 30, height = 22, dpi = 600)
# Saves Institution plot ~
ggsave(Final_Panel, file = "SBBEPanel.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 30, height = 30, dpi = 600)
Final_Panel <- Geral_Plot / Map / (Institution_Plot | Gender_PlotUp) +
plot_layout(heights = c(.5, 1, 1))
# Saves Institution plot ~
ggsave(Final_Panel, file = "SBBEPanel.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 30, height = 30, dpi = 600)
Final_Panel <- Geral_Plot / Map / (Institution_Plot | Gender_PlotUp) +
plot_layout(heights = c(.3, 1, 1))
# Saves Institution plot ~
ggsave(Final_Panel, file = "SBBEPanel.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 30, height = 30, dpi = 600)
Final_Panel <- Geral_Plot / Map / (Institution_Plot | Gender_PlotUp) +
plot_layout(heights = c(.3, .75, .75))
# Saves Institution plot ~
ggsave(Final_Panel, file = "SBBEPanel.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 30, height = 30, dpi = 600)
Final_Panel <- Geral_Plot / Map / (Institution_Plot | Gender_PlotUp) +
plot_layout(heights = c(1, 1, 1))
# Saves Institution plot ~
ggsave(Final_Panel, file = "SBBEPanel.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 20, height = 20, dpi = 600)
plot_layout(heights = c(1, 1)
# Saves Institution plot ~
ggsave(Final_Panel, file = "SBBEPanel.pdf", limitsize = FALSE,
Final_Panel <- Geral_Plot / (Institution_Plot | Gender_PlotUp)
# Saves Institution plot ~
ggsave(Final_Panel, file = "SBBEPanel.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 20, height = 20, dpi = 600)
Final_Panel <- Geral_Plot / (Institution_Plot | Gender_PlotUp) +
plot_layout(heights = c(.5, 1))
# Saves Institution plot ~
ggsave(Final_Panel, file = "SBBEPanel.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 20, height = 20, dpi = 600)
# Saves Institution plot ~
ggsave(Final_Panel, file = "SBBEPanel.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 24, height = 20, dpi = 600)
# Saves Institution plot ~
ggsave(Final_Panel, file = "SBBEPanel.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 26, height = 20, dpi = 600)
# Saves Institution plot ~
ggsave(Final_Panel, file = "SBBEPanel.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 30, height = 20, dpi = 600)
Final_Panel <- Geral_Plot / (Institution_Plot | Gender_PlotUp) +
plot_layout(heights = c(.4, 1))
# Saves Institution plot ~
ggsave(Final_Panel, file = "SBBEPanel.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 30, height = 20, dpi = 600)
# Create the plot
Geral_Plot <-
ggplot() +
geom_text(data = text, aes(x, y, label = label), color = "#ffffff", size = 10, fontface = "bold", family = "Cormorant") +
geom_text(data = numbers_1, aes(x, y, label = label), color = "#ffffff", size = 16, fontface = "bold", family = "Cormorant") +
geom_text(data = numbers_2, aes(x, y, label = label), color = "#ffffff", size = 16, fontface = "bold", family = "Cormorant") +
geom_text(data = icons_1, aes(x, y, label = label), family = "fontawesome-webfont", size = 12, color = "#ffffff") +
geom_text(data = icons_2, aes(x, y, label = label), family = "fontawesome-webfont", size = 12, color = "#ffffff") +
annotate("text", x = .5, y = .85, label = "A SBBE em Números",
family = "Cormorant", size = 14, fontface = "bold", color = "#ffffff") +
scale_x_continuous(limits = c(0, 1), expand = c(0, 0)) +
scale_y_continuous(limits = c(0, 1), expand = c(0, 0)) +
theme(panel.background = element_rect(fill = "#365338", color = NA),
plot.background = element_rect(fill = "#365338", color = NA),
panel.grid = element_blank(),
panel.border = element_blank(),
plot.margin = unit(c(0, 0, 0, -1), "cm"),
legend.position = "none",
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank())
# Creates panel ~
Map <-
ggplot() +
geom_sf(data = fulldf_map, aes(fill = Percentage * 100), colour = "#f7fbff") +
coord_sf(xlim = c(-75.75, -33),
ylim = c(-35, 6.5),
expand = FALSE) +
scale_y_continuous(breaks = c(0, -10, -20, -30)) +
geom_star(data = subset(fulldf_map, Division == "Per Region" & Stats == "Members" & Region == "SBBE24"),
aes(x = Longitude, y = Latitude), size = 4, starshape = 15, starstroke = .3, fill = "#FF7B00", colour = "#000000") +
geom_star(data = subset(fulldf_map, Division == "Per Region" & Region == "Abroad"),
aes(x = Longitude, y = Latitude, fill = Percentage), size = 30, starshape = 8, starstroke = .3, colour = "#f7fbff") +
geom_label(data = subset(fulldf_map, Division == "Per Region" & Stats == "Members" & Region != "SBBE24"),
aes(x = Longitude, y = Latitude, label = Region_PT),
size = 4.5, label.size = .1, family = "Cormorant", fill = "#f7fbff", colour = "#000000") +
geom_label(data = subset(fulldf_map,  Division == "Per Region" & Stats == "Members" & Region == "Abroad"),
aes(x = Longitude, y = Latitude, label = Region_PT),
size = 4.5, label.size = .1, family = "Cormorant", fill = "#f7fbff", colour = "#000000") +
geom_label_repel(data = subset(fulldf_map, Division == "Per Region" & Stats == "Members" & Region == "SBBE24"),
aes(x = Longitude, y = Latitude, label = Region_PT), point.padding = 0,
nudge_x = 3.6, nudge_y = -1, segment.size = 0, segment.color = NA,
size = 4.5, label.size = .1, family = "Cormorant", fill = "#FF7B00", colour = "#000000") +
scale_fill_continuous(low = "#d6d6d6", high = "#004529",
breaks = c(10, 20, 30, 40, 50),
labels = c("10%", "20%", "30%", "40%", "50%"),
limits = c(0, 60)) +
facet_grid(Stats ~ Division, labeller = labeller(Division = xlabel_PT, Stats = ylabel_PT)) +
annotation_scale(data = subset(fulldf_map, Division == "Por Região" & Stats == "Members"),
text_family = "Cormorant", location = "bl", line_width = 1.25, text_cex = 1, style = "ticks",
pad_x = unit(.2, "in"), pad_y = unit(.2, "in")) +
annotation_north_arrow(data = subset(fulldf_map, Division == "Por Região" & Stats == "Members"),
location = "bl", which_north = "true", style = north_arrow_fancy_orienteering,
pad_x = unit(.2, "in"), pad_y = unit(.3, "in")) +
theme(legend.position = "right",
legend.margin = margin(t = 0, b = 0, r = 0, l = 30),
legend.box.margin = margin(t = 0, b = 20, r = 0, l = 0),
panel.background = element_rect(fill = "#f7fbff"),
panel.border = element_rect(colour = "#000000", linewidth = .25, fill = NA),
panel.grid.major = element_line(color = "#d9d9d9", linetype = "dashed", linewidth = .00005),
plot.margin =  margin(t = 0, b = 0, r = .5, l = .5, unit = "cm"),
axis.text = element_text(color = "#000000", size = 13, face = "bold"),
axis.title = element_blank(),
axis.ticks = element_line(color = "#000000", linewidth = .25),
strip.text = element_text(family = "Cormorant", colour = "#000000", size = 22, face = "bold"),
strip.background = element_rect(colour = "#000000", fill = "#d6d6d6", linewidth = .25)) +
guides(fill = guide_colourbar(title = "", label.theme = element_text(family = "Cormorant", size = 14, face = "bold"),
barwidth = 1.5, barheight = 14, order = 1, frame.linetype = 1, frame.colour = "#000000",
ticks.colour = "#f7fbff", direction = "vertical", reverse = FALSE, even.steps = TRUE,
draw.ulim = TRUE, draw.llim = TRUE))
Final_Panel <- Geral_Plot / (Institution_Plot | Gender_PlotUp) +
plot_layout(heights = c(.4, 1))
# Saves Institution plot ~
ggsave(Final_Panel, file = "SBBEPanel.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 30, height = 20, dpi = 600)
ggsave(Map, file = "SBBEMap.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 20, height = 20, dpi = 600)
ggsave(Map, file = "SBBEMap.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 20, height = 10, dpi = 600)
ggsave(Map, file = "SBBEMap.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 18, height = 10, dpi = 600)
ggsave(Map, file = "SBBEMap.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 16, height = 10, dpi = 600)
ggsave(Map, file = "SBBEMap.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 16, height = 8, dpi = 600)
# Creates panel ~
Map <-
ggplot() +
geom_sf(data = fulldf_map, aes(fill = Percentage * 100), colour = "#f7fbff") +
coord_sf(xlim = c(-75.75, -33),
ylim = c(-35, 6.5),
expand = FALSE) +
scale_y_continuous(breaks = c(0, -10, -20, -30)) +
geom_star(data = subset(fulldf_map, Division == "Per Region" & Stats == "Members" & Region == "SBBE24"),
aes(x = Longitude, y = Latitude), size = 4, starshape = 15, starstroke = .3, fill = "#FF7B00", colour = "#000000") +
geom_star(data = subset(fulldf_map, Division == "Per Region" & Region == "Abroad"),
aes(x = Longitude, y = Latitude, fill = Percentage), size = 30, starshape = 8, starstroke = .3, colour = "#f7fbff") +
geom_label(data = subset(fulldf_map, Division == "Per Region" & Stats == "Members" & Region != "SBBE24"),
aes(x = Longitude, y = Latitude, label = Region_PT),
size = 4.5, label.size = .1, family = "Cormorant", fill = "#f7fbff", colour = "#000000") +
geom_label(data = subset(fulldf_map,  Division == "Per Region" & Stats == "Members" & Region == "Abroad"),
aes(x = Longitude, y = Latitude, label = Region_PT),
size = 4.5, label.size = .1, family = "Cormorant", fill = "#f7fbff", colour = "#000000") +
geom_label_repel(data = subset(fulldf_map, Division == "Per Region" & Stats == "Members" & Region == "SBBE24"),
aes(x = Longitude, y = Latitude, label = Region_PT), point.padding = 0,
nudge_x = 3.6, nudge_y = -1, segment.size = 0, segment.color = NA,
size = 4.5, label.size = .1, family = "Cormorant", fill = "#FF7B00", colour = "#000000") +
scale_fill_continuous(low = "#d6d6d6", high = "#004529",
breaks = c(10, 20, 30, 40, 50),
labels = c("10%", "20%", "30%", "40%", "50%"),
limits = c(0, 60)) +
facet_grid(Stats ~ Division, labeller = labeller(Division = xlabel_PT, Stats = ylabel_PT)) +
annotation_scale(data = subset(fulldf_map, Division == "Por Região" & Stats == "Members"),
text_family = "Cormorant", location = "bl", line_width = 1.25, text_cex = 1, style = "ticks",
pad_x = unit(.2, "in"), pad_y = unit(.2, "in")) +
annotation_north_arrow(data = subset(fulldf_map, Division == "Por Região" & Stats == "Members"),
location = "bl", which_north = "true", style = north_arrow_fancy_orienteering,
pad_x = unit(.2, "in"), pad_y = unit(.3, "in")) +
theme(legend.position = "right",
legend.margin = margin(t = 0, b = 0, r = 0, l = 30),
legend.box.margin = margin(t = 0, b = 20, r = 0, l = 0),
panel.background = element_rect(fill = "#f7fbff"),
panel.border = element_rect(colour = "#000000", linewidth = .25, fill = NA),
panel.grid.major = element_line(color = "#d9d9d9", linetype = "dashed", linewidth = .00005),
plot.margin =  margin(t = 0, b = 0, r = .5, l = .5, unit = "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_line(color = "#000000", linewidth = .25),
strip.text = element_text(family = "Cormorant", colour = "#000000", size = 22, face = "bold"),
strip.background = element_rect(colour = "#000000", fill = "#d6d6d6", linewidth = .25)) +
guides(fill = guide_colourbar(title = "", label.theme = element_text(family = "Cormorant", size = 14, face = "bold"),
barwidth = 1.5, barheight = 14, order = 1, frame.linetype = 1, frame.colour = "#000000",
ticks.colour = "#f7fbff", direction = "vertical", reverse = FALSE, even.steps = TRUE,
draw.ulim = TRUE, draw.llim = TRUE))
Final_Panel <- Geral_Plot / (Institution_Plot | Gender_PlotUp) +
plot_layout(heights = c(.4, 1))
# Saves Institution plot ~
ggsave(Final_Panel, file = "SBBEPanel.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 30, height = 20, dpi = 600)
ggsave(Map, file = "SBBEMap.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 16, height = 8, dpi = 600)
# Creates panel ~
Map <-
ggplot() +
geom_sf(data = fulldf_map, aes(fill = Percentage * 100), colour = "#f7fbff") +
coord_sf(xlim = c(-75.75, -33),
ylim = c(-35, 6.5),
expand = FALSE) +
scale_y_continuous(breaks = c(0, -10, -20, -30)) +
geom_star(data = subset(fulldf_map, Division == "Per Region" & Stats == "Members" & Region == "SBBE24"),
aes(x = Longitude, y = Latitude), size = 4, starshape = 15, starstroke = .3, fill = "#FF7B00", colour = "#000000") +
geom_star(data = subset(fulldf_map, Division == "Per Region" & Region == "Abroad"),
aes(x = Longitude, y = Latitude, fill = Percentage), size = 30, starshape = 8, starstroke = .3, colour = "#f7fbff") +
geom_label(data = subset(fulldf_map, Division == "Per Region" & Stats == "Members" & Region != "SBBE24"),
aes(x = Longitude, y = Latitude, label = Region_PT),
size = 4.5, label.size = .1, family = "Cormorant", fill = "#f7fbff", colour = "#000000") +
geom_label(data = subset(fulldf_map,  Division == "Per Region" & Stats == "Members" & Region == "Abroad"),
aes(x = Longitude, y = Latitude, label = Region_PT),
size = 4.5, label.size = .1, family = "Cormorant", fill = "#f7fbff", colour = "#000000") +
geom_label_repel(data = subset(fulldf_map, Division == "Per Region" & Stats == "Members" & Region == "SBBE24"),
aes(x = Longitude, y = Latitude, label = Region_PT), point.padding = 0,
nudge_x = 3.6, nudge_y = -1, segment.size = 0, segment.color = NA,
size = 4.5, label.size = .1, family = "Cormorant", fill = "#FF7B00", colour = "#000000") +
scale_fill_continuous(low = "#d6d6d6", high = "#004529",
breaks = c(10, 20, 30, 40, 50),
labels = c("10%", "20%", "30%", "40%", "50%"),
limits = c(0, 60)) +
facet_grid(Stats ~ Division, labeller = labeller(Division = xlabel_PT, Stats = ylabel_PT)) +
annotation_scale(data = subset(fulldf_map, Division == "Por Região" & Stats == "Members"),
text_family = "Cormorant", location = "bl", line_width = 1.25, text_cex = 1, style = "ticks",
pad_x = unit(.2, "in"), pad_y = unit(.2, "in")) +
annotation_north_arrow(data = subset(fulldf_map, Division == "Por Região" & Stats == "Members"),
location = "bl", which_north = "true", style = north_arrow_fancy_orienteering,
pad_x = unit(.2, "in"), pad_y = unit(.3, "in")) +
theme(legend.position = "right",
legend.margin = margin(t = 0, b = 0, r = 0, l = 30),
legend.box.margin = margin(t = 0, b = 20, r = 0, l = 0),
panel.background = element_rect(fill = "#f7fbff"),
panel.border = element_rect(colour = "#000000", linewidth = .25, fill = NA),
panel.grid.major = element_line(color = "#d9d9d9", linetype = "dashed", linewidth = .00005),
plot.margin =  margin(t = 0, b = 0, r = .5, l = .5, unit = "cm"),
axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
strip.text = element_text(family = "Cormorant", colour = "#000000", size = 22, face = "bold"),
strip.background = element_rect(colour = "#000000", fill = "#d6d6d6", linewidth = .25)) +
guides(fill = guide_colourbar(title = "", label.theme = element_text(family = "Cormorant", size = 14, face = "bold"),
barwidth = 1.5, barheight = 14, order = 1, frame.linetype = 1, frame.colour = "#000000",
ticks.colour = "#f7fbff", direction = "vertical", reverse = FALSE, even.steps = TRUE,
draw.ulim = TRUE, draw.llim = TRUE))
Final_Panel <- Geral_Plot / (Institution_Plot | Gender_PlotUp) +
plot_layout(heights = c(.4, 1))
# Saves Institution plot ~
ggsave(Final_Panel, file = "SBBEPanel.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 30, height = 20, dpi = 600)
ggsave(Map, file = "SBBEMap.pdf", limitsize = FALSE,
device = cairo_pdf, scale = 1, width = 16, height = 8, dpi = 600)
